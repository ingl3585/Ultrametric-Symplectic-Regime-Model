# Configuration for Ultrametric-Symplectic Regime Model
# Version: 1.1
# Timeframe: Configurable (1-minute or 15-minute bars)

# Timeframe configuration
timeframe:
  bar_size_minutes: 3        # Bar size in minutes (3m = good balance between 1m and 15m)

# Volume processing parameters
volume:
  normalization_window: 400   # Bars for rolling mean normalization (400 bars @ 3m = 20 hours)
  ema_period: 5               # Period for EMA smoothing

# Signal generation parameters
signal:
  theta_ar1: 0.0001          # Threshold for AR(1) signals (in log space)
  theta_symplectic: 0.00005  # Threshold for symplectic signals - balanced
  epsilon_gate: 2.0          # Max ultrametric distance to centroid - balanced
  hit_threshold: 0.52        # Minimum cluster hit rate to trade (52% = positive expectancy after costs)

# Segment parameters (for STEP 1+)
segments:
  K: 20                      # Number of bars per segment (20 bars @ 3m = 60 minutes = 1 hour)

# Ultrametric distance parameters (for STEP 1+)
ultrametric:
  base_b: 1.2                # Base for ultrametric valuation (smaller = finer granularity)
  eps: 1.0e-10               # Small value for numerical stability

# Clustering parameters (for STEP 2+)
clustering:
  num_clusters: 5            # Target number of clusters (reduced for better balance)
  min_cluster_size: 30       # Minimum segments per valid cluster (lowered to keep more clusters)
  subsample_size: 5000       # Max segments for distance matrix

# Symplectic model parameters
symplectic:
  encoding: 'A'              # 'A' (volume), 'B' (price), or 'C' (hybrid)
  dt: 1.0                    # Time step for leapfrog integrator
  kappa_min: 0.01            # Minimum allowed kappa
  kappa_max: 10.0            # Maximum allowed kappa

# Cost model (NQ approximation)
costs:
  cost_per_trade: -0.00048   # Per round-trip cost in log space (~0.048%, same for 1m and 15m)

# Backtesting parameters
backtest:
  train_split: 0.6           # Fraction of data for training
  val_split: 0.2             # Fraction of data for validation
  test_split: 0.2            # Fraction of data for testing
